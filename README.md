# Matrix Synapse + LiveKit (HowTo)

–ó–¥–µ—Å—å –æ–ø–∏—Å–∞–Ω –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è Matrix-—Å–µ—Ä–≤–µ—Ä–∞ Synapse —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–æ–≤ —á–µ—Ä–µ–∑ LiveKit –Ω–∞ Synology NAS (DSM 7) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Container Manager (Docker).

## –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —É—Å–ª–æ–≤–∏—è

- Synology DSM 7.x —Å –∞–¥–º–∏–Ω—Å–∫–∏–º –¥–æ—Å—Ç—É–ø–æ–º, –≤ —Ç–æ–º —á–∏—Å–ª–µ –∏ –ø–æ SSH
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø–∞–∫–µ—Ç `Container Manager`
- –ù–∞–ª–∏—á–∏–µ –¥–æ–º–µ–Ω–∞, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª—è—Ç—å –∏–º, –∞ —Ç–∞–∫–∂–µ –≤–∞–ª–∏–¥–Ω–æ–≥–æ SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö (–ø–æ–¥)–¥–æ–º–µ–Ω–æ–≤, –∏–Ω–∞—á–µ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ –±—É–¥–µ—Ç.

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–≤–µ—Ä—è–ª–∞—Å—å –Ω–∞ –±–µ–ª–æ–º —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–º IP-–∞–¥—Ä–µ—Å–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞, –∫–∞–∫ –æ–Ω–∞ –±—É–¥–µ—Ç –≤–µ—Å—Ç–∏ —Å–µ–±—è –Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–º –∞–¥—Ä–µ—Å–µ - –Ω–µ –∑–Ω–∞—é, –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ.
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–∞–ª—ã–º–∏ –≥—Ä—É–ø–ø–∞–º–∏ –ª—é–¥–µ–π, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–º–∞, –∏ –Ω–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–∞ –Ω–∞ –±–æ–ª—å—à–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏, –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –°–£–ë–î `SQLite`, –∫–æ—Ç–æ—Ä—É—é –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏ –Ω–µ—Å–ª–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `PostgreSQL` –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ.

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è

### –ü—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–æ–≤ –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ
–ù–∞–ø—Ä–∞–≤—å—Ç–µ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π IP Synology:
- TCP: 80 (HTTP), 443 (HTTPS) - —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ
- UDP: 50100-50200 (LiveKit Media)

–ù–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:
- TCP/UDP: 3478 (Matrix TURN)
- TCP: 7881 (LiveKit Signal/TCP fallback)
- UDP: 30000-40000 (LiveKit Media TURN relay)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Synology Reverse Proxy
–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥–¥–æ–º–µ–Ω–∞ —Å–æ–∑–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –≤ `–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è` > `–ü–æ—Ä—Ç–∞–ª –¥–ª—è –≤—Ö–æ–¥–∞` > `–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ` > `–û–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏`:
- `matrix.example.com:443` -> `http://localhost:18080` (WebSocket: ON)
- `auth.example.com:443` -> `http://localhost:18080` (WebSocket: ON)
- `livekit.example.com:443` -> `http://localhost:18080` (WebSocket: ON)
- `example.com:443` -> `http://localhost:18080` (WebSocket: ON) - –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ, —Å–º. [–ù—é–∞–Ω—Å—ã](#–Ω—é–∞–Ω—Å—ã-—Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è) –Ω–∏–∂–µ

## –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

–ó–∞–π–¥–∏—Ç–µ –ø–æ SSH –Ω–∞ Synology –ø–æ–¥ –∞–¥–º–∏–Ω–æ–º, –∑–∞—Ç–µ–º –ø–æ–¥ `root`:
```bash
sudo -i
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è (–º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤ –ø–∞–ø–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `root`):
```bash
curl -sLO https://raw.githubusercontent.com/arabezar/matrix-synapse-synology/main/install.sh && chmod +x install.sh && ./install.sh
```
> [!NOTE]
> –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–∞ –∫–æ–º–∞–Ω–¥–∞: –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Å–∫—Ä–∏–ø—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –µ–≥–æ.
> 
> –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è, —Å–æ–∑–¥–∞—ë—Ç –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞ –≤ –ø–∞–ø–∫–µ `docker`, –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ñ–∞–π–ª–µ `.env`, –∑–∞–≥—Ä—É–∂–∞–µ—Ç —à–∞–±–ª–æ–Ω—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ —Å–æ–∑–¥–∞–Ω–Ω—É—é –ø–∞–ø–∫—É, –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –∫–ª—é—á–∞ `Matrix`, –∂–¥—ë—Ç —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ `Container Manager` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É —Å–æ–∑–¥–∞–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
> 
> –°–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ —Å–æ–∑–¥–∞–Ω–Ω–æ–π –ø–æ–¥–ø–∞–ø–∫–µ `docker`, –±–æ–ª—å—à–µ –Ω–∏–≥–¥–µ –∏ –Ω–∏—á–µ–≥–æ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç.
> 
> –°–∫—Ä–∏–ø—Ç –º–æ–∂–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –Ω–∞–∂–∞—Ç–∏–µ–º `Ctrl+C`

–û—Ç–≤–µ—á–∞–π—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ–º —Å–∫—Ä–∏–ø—Ç–∞. –í –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç –ø–µ—Ä–µ–π—Ç–∏ –≤ `Container Manager`. –°–æ–∑–¥–∞–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ `Container Manager` > `–ü—Ä–æ–µ–∫—Ç` > `–°–æ–∑–¥–∞—Ç—å` > `–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `matrix-synapse`) + `–ü—É—Ç—å` > `–ó–∞–¥–∞—Ç—å` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/docker/matrix-synapse`) > `–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª docker-compose.yml –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞` > `–î–∞–ª–µ–µ`‚Ä¶, –ø–æ—Å–ª–µ —á–µ–≥–æ –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ —Å–∫—Ä–∏–ø—Ç—É –∏ –∑–∞–¥–∞–π—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è-–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞. –ï—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∞, –∞ —Å–∞–º–∏ —Ö–æ—Ç–∏—Ç–µ –∏–º –±—ã—Ç—å, –∑–∞–º–µ–Ω–∏—Ç–µ –∏–º—è `admin` –Ω–∞ —Å–≤–æ—ë, –∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —Ç.–µ. –í—ã, —Å—Ä–∞–∑—É —Å—Ç–∞–Ω–µ—Ç –∞–¥–º–∏–Ω–æ–º.
<details>
<summary>–ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–π –ª–æ–≥ —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞</summary>

```bash
ash-4.4# curl -sLO https://raw.githubusercontent.com/arabezar/matrix-synapse-synology/main/install.sh && chmod +x install.sh && ./install.sh
–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Matrix Synapse + LiveKit in Docker v0.0.1...
–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —É—Å–ª–æ–≤–∏–π...
–ó–∞–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞ [matrix-synapse] (Enter - –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å):
–°–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è...
–û—Å–Ω–æ–≤–Ω–æ–π –¥–æ–º–µ–Ω [example.com] (Enter - –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å):
–î–æ–º–µ–Ω Matrix [matrix.example.com] (Enter - –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å):
–î–æ–º–µ–Ω LiveKit [matrixrtc-livekit.example.com] (Enter - –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å):
–î–æ–º–µ–Ω LiveKit Auth [matrixrtc-auth.example.com] (Enter - –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å):
–°–µ–∫—Ä–µ—Ç–Ω–∞—è —Ñ—Ä–∞–∑–∞ (—Ç–æ–∫–µ–Ω): Bla-bla-bla
–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤...
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ –ø–æ–¥–ø–∏—Å–∏ Matrix –∏/–∏–ª–∏ homeserver.yaml...
Generating config file /data/homeserver.yaml
Generating signing key file /data/example.com.signing.key
A config file has been generated in '/data/homeserver.yaml' for server name 'example.com'. Please review this file and customise it to your needs.
Creating log config /data/example.com.log.config
Setting ownership on /data to 991:991
–°–æ–∑–¥–∞–π—Ç–µ –≤ Container Manager –ø—Ä–æ–µ–∫—Ç matrix-synapse, –∑–∞–¥–∞–π—Ç–µ –ø—É—Ç—å /docker/matrix-synapse, –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –∑–¥–µ—Å—å... –∑–∞–¥–∞–π—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è-–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ [admin] (Enter - –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å):
–°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ Matrix...
Enter Password:
Confirm Password:
Sending registration request...
Success!
‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Matrix Synapse –∑–∞–≤–µ—Ä—à–µ–Ω–∞

```
</details>

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
–ü–æ—Å–ª–µ–¥—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥–æ–π (–ø–∞—Ä–æ–ª—å –±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—à–µ–Ω –¥–≤–∞–∂–¥—ã –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –∫–æ–º–∞–Ω–¥—ã, –∑–∞–ø—É—Å–∫–∞—Ç—å –∏–∑ –ø–∞–ø–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ `docker`):

```bash
docker exec -it matrix-synapse register_new_matrix_user https://matrix.example.com -c /data/homeserver.yaml -u <user_name>
```

### –ù—é–∞–Ω—Å—ã —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è
> [!TIP]
> –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –∏–º—è –∫–∞–∫ `matrix.example.com`, —Ç–∞–∫ –∏ `example.com`, –æ—Ç —ç—Ç–æ–≥–æ –±—É–¥–µ—Ç –∑–∞–≤–∏—Å–µ—Ç—å —Å—É—Ñ—Ñ–∏–∫—Å –ø–æ–ª–Ω–æ–≥–æ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: `@admin:matrix.example.com` –∏–ª–∏ `@admin:example.com`. –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫—Ä–∞—Ç–∫–∞—è —Ñ–æ—Ä–º–∞ `example.com`, —Ç–æ –¥–æ–º–µ–Ω –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ [–ø—Ä–æ–±—Ä–æ—Å–∏—Ç—å —á–µ—Ä–µ–∑ –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-synology-reverse-proxy), —á—Ç–æ–±—ã —Å–µ—Ä–≤–µ—Ä Matrix –∏–º–µ–ª –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –¥–æ–º–µ–Ω–æ–º, –ø—Ä–∏ —ç—Ç–æ–º –≤—Å–µ ¬´–ª–∏—à–Ω–∏–µ¬ª –∑–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã Synology –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏, —Å–µ—Ä–≤–µ—Ä Matrix –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –¥–ª—è –Ω–µ–≥–æ. –ï—Å–ª–∏ –≤—ã —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å ¬´–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º¬ª –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º `example.com`, –ø—Ä–æ—Å—Ç–æ –Ω–µ –¥–µ–ª–∞–π—Ç–µ –µ–≥–æ –ø—Ä–æ–±—Ä–æ—Å –Ω–∞ –ø—Ä–æ–∫—Å–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤, –Ω–æ –≤–∞—à–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç –∏–º–µ—Ç –¥–ª–∏–Ω–Ω—ã–π —Å—É—Ñ—Ñ–∏–∫—Å `matrix.example.com`, —á—Ç–æ –∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–µ –º–µ—à–∞–µ—Ç –Ω–∏–∫–∞–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.

### –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞
> [!TIP]
> –ï—Å–ª–∏ –≤ –º–æ–º–µ–Ω—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —á—Ç–æ-—Ç–æ –Ω–µ —É—Å—Ç—Ä–æ–∏–ª–æ, –≤—Å–µ–≥–¥–∞ –º–æ–∂–Ω–æ –ø—Ä–µ—Ä–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –∏ –Ω–∞—á–∞—Ç—å –µ–≥–æ —Å–Ω–æ–≤–∞ (`./install.sh`). –õ—é–±—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –º–æ–≥—É—Ç –±—ã—Ç—å —É–¥–∞–ª–µ–Ω—ã, –∏–Ω—Å—Ç–∞–ª–ª—è—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∏—Ç –∏—Ö –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ. –° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –µ—Å–ª–∏ –∫–∞–∫–∏–µ-—Ç–æ —Ñ–∞–π–ª—ã –Ω–µ —É–¥–∞–ª—è—Ç—å, —Ç–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ–Ω–∏ –Ω–µ –±—É–¥—É—Ç.

> [!IMPORTANT]
> –ü–∞–ø–∫–∞ `data` —Ö—Ä–∞–Ω–∏—Ç –≤—Å—é –±–∞–∑—É —Å–æ–æ–±—â–µ–Ω–∏–π, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∞ —Ç–∞–∫–∂–µ –∫–ª—é—á –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ Synapse, –µ—Å–ª–∏ —É–¥–∞–ª–∏—Ç—å –ø–∞–ø–∫—É, –≤—ã –ø–æ—Ç–µ—Ä—è–µ—Ç–µ –∏ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∏ –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –ø—Ä–∏–¥—ë—Ç—Å—è –∑–∞–Ω–æ–≤–æ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –≤–∫–ª—é—á–∞—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

> [!CAUTION]
> –§–∞–π–ª `.env` —Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –≤–≤–µ–¥—ë–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∏–Ω—Å—Ç–∞–ª–ª—è—Ç–æ—Ä–æ–º. –¢–∞–∫–∂–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –∏–≥—Ä–∞–µ—Ç –≤–∞–∂–Ω—É—é —Ä–æ–ª—å –¥–ª—è –∞–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ `compose.yaml` –∏ `proxy.conf.template`, –æ–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ –≤ —Ñ–∞–π–ª–µ –≤—Ä—É—á–Ω—É—é –∏–∑–º–µ–Ω–∏—Ç—å –∫–∞–∫–∏–µ-—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –æ–Ω–∏ –Ω–µ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö `homeserver.yaml` –∏ `livekit.yaml`. –°–∞–º—ã–º –ø—Ä–æ—Å—Ç—ã–º –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ `.env` —Ñ–∞–π–ª–µ —è–≤–ª—è–µ—Ç—Å—è —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ `homeserver.yaml` –∏ `livekit.yaml` –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ –∏–Ω—Å—Ç–∞–ª–ª—è—Ç–æ—Ä–∞ `./install.sh`, –≥–¥–µ –≤—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç `Container Manager`.

### –£–¥–∞–ª–µ–Ω–∏–µ
–ï—Å–ª–∏ –ø–æ –∫–∞–∫–∏–º-—Ç–æ –ø—Ä–∏—á–∏–Ω–∞–º —Ç—Ä–µ–±—É–µ—Ç—Å—è —É–¥–∞–ª–∏—Ç—å —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–π –ø—Ä–æ–µ–∫—Ç, —Å–ª–µ–¥—É–µ—Ç –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ –≤ `Container Manager` –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—ã–∑–≤–∞—Ç—å –¥–≤–∞ –ø—É–Ω–∫—Ç–∞ –º–µ–Ω—é `–î–µ–π—Å—Ç–≤–∏—è`: `–û—á–∏—Å—Ç–∏—Ç—å` (–±—É–¥—É—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã, –µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω—ã, –∏ —É–¥–∞–ª–µ–Ω—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã) –∏ `–£–¥–∞–ª–∏—Ç—å` (–±—É–¥–µ—Ç —É–¥–∞–ª—ë–Ω –ø—Ä–æ–µ–∫—Ç). –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –ø–∞–ø–∫–µ `matrix-synapse` –æ—Å—Ç–∞–Ω—É—Ç—Å—è –∏ —É–¥–∞–ª–µ–Ω—ã –Ω–µ –±—É–¥—É—Ç, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç, —É–∫–∞–∑–∞–≤ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–æ–µ–∫—Ç–∞ –ø–∞–ø–∫—É `matrix-synapse`.

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞
–ï—Å—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä, [testmatrix](https://codeberg.org/spaetz/testmatrix), - –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏ `VS Code` –≤–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:
```bash
testmatrix exemple.com
```
<details>
<summary>–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —É–∫–∞–∂–µ—Ç –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ä–≤–µ—Ä–æ–º</summary>

```bash
Testing server example.com
  Federation url: https://matrix.example.com:443
‚úî Server well-known exists
‚úî Client well-known has proper CORS header
  Client url: https://example.com
  Adding livekit service URL: https://auth.example.com
‚úî Server version: Dendrite (0.15.2+e546df2)
‚úî Federation API endpoints seem to work fine
‚úî Client API endpoints seem to work fine
  QR code login is disabled (MSC 4108)
  Public room directory is enabled
‚úî MatrixRTC SFU configured
  JWTauth healtz url: https://auth.example.com
  jwt has no CORS header (that is OK)
‚úî JWTauth responds
‚úî jwt /sfu/get without auth returns (405). This is good!
  jwt: no credentials passed, not trying authed requests
êÑÇ MatrixRTC configured but delayed events turned off (MSC4140). BAD!
  No room summaries (MSC3266) (unstable) support
êÑÇ Direct open registration might not be forbidden!
```
> –ù–µ –æ–±—Ä–∞—â–∞–π—Ç–µ –≤–Ω–∏–º–∞–Ω–∏—è –Ω–∞ –∫—Ä–µ—Å—Ç–∏–∫–∏ –≤–Ω–∏–∑—É: –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ MSC4140 –≤ `Dendrite`, –ø–æ—Å–ª–µ–¥–Ω–∏–π –Ω–∞—á–∏–Ω–∞–µ—Ç –±–µ–∑–±–æ–∂–Ω–æ –≥–ª—é—á–∏—Ç—å, - –≤–∏–¥–µ–æ —Ä–≤—ë—Ç—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è; –∞ –≤—Ç–æ—Ä–æ–π –∫—Ä–µ—Å—Ç–∏–∫ –æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Ç.–∫. –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –æ—Ç–∫—Ä—ã—Ç–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–ø—Ä–µ—â–µ–Ω–∞.
</details>
–ú–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Ç–æ–∫–µ–Ω–∞ (–∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ UI –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è; –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ Element Web - –∫–ª–∏–∫ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ > –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ > –ü–æ–º–æ—â—å –∏ –æ –ø—Ä–æ–≥—Ä–∞–º–º–µ > –¢–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞)

```bash
testmatrix -u admin -t <token> exemple.com
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∑–∞–π—Ç–∏ –Ω–∞ —Å–≤–æ–π —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ –∫–æ–∏–µ–Ω—Ç–∞ [Element Web](https://app.element.io): `–í–æ–π—Ç–∏` > `–ò–∑–º–µ–Ω–∏—Ç—å` —Å–µ—Ä–≤–µ—Ä –Ω–∞ —Å–≤–æ–π `example.com` > `–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å` > –í–≤–µ—Å—Ç–∏ –∏–º—è —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ —Ä–∞–Ω–µ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–∞—Ä–æ–ª—å > `–í–æ–π—Ç–∏`.

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- [Synology](https://www.synology.com/)    
- [Docker](https://www.docker.com/)
- [Matrix](https://matrix.org), [Matrix Dendrite](https://github.com/matrix-org/dendrite), [Continuwuity](https://continuwuity.org), [Matrix server setup using Ansible and Docker](https://github.com/spantaleev/matrix-docker-ansible-deploy), [Adding bridges](https://gitlab.com/rogs/dendrite-docker-bridges)
- [–ö–ª–∏–µ–Ω—Ç—ã Element](https://element.io/download)

## –í–∫–ª–∞–¥

- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏ –∑–∞–º–µ—á–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏—á–µ—Å–∫–∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è [–∑–¥–µ—Å—å](https://github.com/arabezar/matrix-synapse-synology/discussions)





